version: v1alpha1
debug: false
persist: true
machine:
  type: controlplane
  kubelet:
    image: ghcr.io/siderolabs/kubelet:v1.31.0
    extraArgs:
      rotate-server-certificates: true
  network:
    hostname: talos-cp-01
    interfaces:
      - interface: eth0
        dhcp: false
        addresses:
          - 10.30.0.11/24
        routes:
          - network: 0.0.0.0/0
            gateway: 10.30.0.1
    nameservers:
      - 1.1.1.1
      - 8.8.8.8
  install:
    disk: /dev/sda
    image: ghcr.io/siderolabs/installer:v1.11.2
    wipe: true
  features:
    rbac: true
    stableHostname: true
cluster:
  clusterName: homelab-test
  controlPlane:
    endpoint: https://10.30.0.11:6443
  network:
    cni:
      name: custom
      urls:
        - https://raw.githubusercontent.com/cilium/cilium/1.16.3/install/kubernetes/quick-install.yaml
    dnsDomain: cluster.local
    podSubnets:
      - 10.244.0.0/16
    serviceSubnets:
      - 10.96.0.0/12
  proxy:
    disabled: true
  apiServer:
    certSANs:
      - 10.30.0.11
  controllerManager: {}
  scheduler: {}
  discovery:
    enabled: true
    registries:
      kubernetes:
        disabled: false
      service:
        disabled: false
  etcd:
    advertisedSubnets:
      - 10.30.0.0/24
