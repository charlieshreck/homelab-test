# Grafana Mimir - Monolithic Mode (using mimir-distributed chart)
# Chart: grafana/mimir-distributed version 5.5.0
# Configured for single-instance monolithic deployment

# Global settings
global:
  dnsService: "kube-dns"
  clusterDomain: "cluster.local"

# Mimir configuration
mimir:
  structuredConfig:
    multitenancy_enabled: false

    limits:
      compactor_blocks_retention_period: 15d
      max_global_series_per_user: 500000
      ingestion_rate: 50000

    common:
      storage:
        backend: filesystem

# =============================================================================
# MONOLITHIC MODE: Enable only mimir-backend with all components
# =============================================================================

# Mimir backend - runs all components in one pod
mimir-backend:
  enabled: true
  replicas: 1

  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 2000m
      memory: 2Gi

  persistence:
    enabled: true
    storageClass: mayastor-2
    size: 50Gi

# =============================================================================
# DISABLE ALL MICROSERVICES
# =============================================================================

alertmanager:
  enabled: false

compactor:
  enabled: false

distributor:
  enabled: false

ingester:
  enabled: false
  zoneAwareReplication:
    enabled: false

overrides_exporter:
  enabled: false

querier:
  enabled: false

query_frontend:
  enabled: false

query_scheduler:
  enabled: false

ruler:
  enabled: false

store_gateway:
  enabled: false
  zoneAwareReplication:
    enabled: false

# =============================================================================
# SUPPORTING SERVICES
# =============================================================================

# Nginx gateway - lightweight reverse proxy
nginx:
  enabled: true
  replicas: 1
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi

# Disable MinIO (using filesystem storage)
minio:
  enabled: false

# Disable memcached
memcached:
  enabled: false

memcachedExporter:
  enabled: false

# Disable rollout operator
rollout_operator:
  enabled: false

# Disable metrics generator
metrics_generator:
  enabled: false

# RBAC
rbac:
  create: true

# Service Account
serviceAccount:
  create: true
  name: mimir
